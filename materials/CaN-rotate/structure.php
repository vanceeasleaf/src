  <?php
	  $home=dirname(__FILE__);
	require_once("$home/../../discript.php");
function rotate($phi,$x,$y){
	$x1=cos($phi)*$x-sin($phi)*$y;
	$y1=sin($phi)*$x+cos($phi)*$y;
	return array($x1,$y1);
}
$pos1=array(
6.928400,13.000369,0.000000
	,7.794450,16.500469,0.000000
	,9.526550,10.500299,0.000000
	,11.258650,17.500498,0.000000
	);
$phi=3.14159265359/2-atan(($pos1[4]-$pos1[1])/($pos1[3]-$pos1[0]));
$bond=sqrt(($pos1[4]-$pos1[1])*($pos1[4]-$pos1[1])+($pos1[3]-$pos1[0])*($pos1[3]-$pos1[0]))*1.42;
		$dx=sqrt(3)*$bond;
		$dy=3*$bond;
	if(!$usinglat){
$latx=floor($xlen/$dx);
$laty=floor($ylen/$dy);
$latz=1;
	}
$pos2=array(
1.02325,3.54463,0
,0.34109,1.18154,0
,5.7984,4.72618,0
,5.11624,2.36309,0
,7.50382,2.95387,0
,3.41082,4.13541,0
,2.72866,1.77231,0
,8.18599,5.31696,0
,6.82166,0.59078,0
,2.04649,14.76931,0
,8.52706,14.17854,0
,5.45733,11.22468,0
,3.75191,12.997,0
,1.36433,12.40622,0
,0.68216,10.04313,0
,6.13949,13.58776,0
,3.06975,10.6339,0
,7.8449,11.81546,0
,6.48057,7.08926,0
,4.77515,8.86159,0
,7.16273,9.45235,0
,1.70542,5.90772,0
,4.09299,6.4985,0
,2.38758,8.27081,0
,0,7.68004,0
,4.43408,0,0
,7.16273,4.33233,0
,4.77515,3.74156,0
,2.38758,3.15078,0
,5.45733,6.10465,0
,3.06975,5.51387,0
,0.68216,4.92311,0
,7.8449,6.69542,0
,4.09299,1.37846,0
,1.70542,0.7877,0
,8.18599,0.19692,0
,6.48057,1.96924,0
,3.41082,14.37546,0
,1.02325,13.7847,0
,0.34109,11.42161,0
,2.72866,12.01237,0
,5.7984,14.96624,0
,5.11624,12.60315,0
,7.50382,13.19392,0
,8.52706,9.0585,0
,6.82166,10.83083,0
,3.75191,7.87696,0
,6.13949,8.46774,0
,1.36433,7.2862,0
,2.04649,9.64928,0
,0,2.56002,0
,4.43408,10.24006,0
);
for($i=0;$i<52;$i++)
		$rpos[$i]=rotate(0,$pos2[$i*3],$pos2[$i*3+1]);
$minx=100000;
$miny=100000;
for($i=0;$i<52;$i++){
	$minx=min($rpos[$i][0],$minx);
	$miny=min($rpos[$i][1],$miny);
}
for($i=0;$i<52;$i++){
	$rpos[$i][0]-=$minx;
	$rpos[$i][1]-=$miny;
}
$nN=52-$nC;
		$file=fopen("cell.in","w");
$content="1
$dx 0 0 
0 $dy 0
0 0 100
$nC $nN
";
for($i=0;$i<52;$i++){
$content=sprintf("$content%f\t%f\t%f\n",$rpos[$i][0]/$dx,$rpos[$i][1]/$dy,0.000000);
}
	fprintf($file,$content);
	$content="7
y
cell.in
y
$latx $laty $latz 
1
3
C N
0
CN.xyz
structure
map.in
";
		$file=fopen("in.disp","w");
	fprintf($file,$content);
	  $home=dirname(__FILE__);	
	shell_exec("$home/../../latgen <in.disp");
?>